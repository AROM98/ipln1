#!/Library/Frameworks/Python.framework/Versions/3.9/bin/python3
"""
filtro para leitura de varios ficheiro passados em linha de comando

...
"""
import sys
from getopt import getopt
from re import *
from pickle import *
import spacy 



BF = {}
# vai chamar-se interact e sera a função que usa o spacy para encontrar ralaçoes entre as personagens.
def procFam(f, i):
    fam = {}
    g = search(r'\bHUSB\s+@(.*)@', i)
    if g:
        fam['husb'] = g.group(1)
    w = search(r'\bWIFE\s+@(.*)@', i)
    if w:
        fam['wife'] = w.group(1)
    c = findall(r'\bCHIL\s+@(.*)@', i)
    fam['child'] = c
    BF[f] = fam

# vai divir livro por capitulos e usar a funçao interact em cada um.
def procTexto(t):
    items = split(r'\n0', t)
    for i in items:
        f = search(r'@(F\d+)@ *FAM', i)
        if f:
            procFam(f.group(1),i)

ops,args = getopt(sys.argv[1:],"a:o:")
ops = dict(ops)
for ficheiro in args:
    with open(ficheiro) as f :
        txt = f.read()
    #processar o texto
    procTexto(txt)


print(BF)
#  rever isto do pickle ---- Pickler.dump()

#diferentes opçoes
if '-a' in ops:
    pass
    #gTree(ops["-a"])


