#!/Library/Frameworks/Python.framework/Versions/3.9/bin/python3
"""
filtro para leitura de varios ficheiro passados em linha de comando

...
"""
import sys
from getopt import getopt
from re import *
from pickle import *
import spacy 




# vai chamar-se interact e sera a função que usa o spacy para encontrar ralaçoes entre as personagens.
def procFam(f, i):
    pass



# vai divir livro por capitulos e usar a funçao interact em cada um.
def procTexto(t):
    text2 = sub(r'\f', '', txt)
    text3 = sub(r'\n\n+', '\n', text2)
    text4 = sub(r'(\n[A-Z])\n', r'\n\1', text3)
    # texto limpo

    capitulos = findall(r'(CHAPTER\ \w+)\s+([A-Z\ \'\,\.\-]+)\s+(.*|\n)(?=CHAPTER\ \w+|Text\ copyright)', text4)
     #    (CHAPTER\ \w+)\n([\w\ ]+)\n\n(.+)      ---  (CHAPTER\ \w+)\s+([A-Z\ \'\,\.\-]+)(.*+)(CHAPTER\ \w+|Text copyright)
    # , titulo, texto
    for cap, titulo, texto, lixo in capitulos:
        print('.....................................\n') 
        print(cap+'\n')
        print(titulo+'\n\n')
        print(texto+'\n')
        print(lixo+'\n')
        print('.....................................\n') 

    #items = split(r'\n0', t)

ops,args = getopt(sys.argv[1:],"a:o:")
ops = dict(ops)
for ficheiro in args:
    with open(ficheiro) as f :
        txt = f.read()
    #processar o texto
    procTexto(txt)


#  rever isto do pickle ---- Pickler.dump()

#diferentes opçoes
if '-a' in ops:
    pass
    #gTree(ops["-a"])


